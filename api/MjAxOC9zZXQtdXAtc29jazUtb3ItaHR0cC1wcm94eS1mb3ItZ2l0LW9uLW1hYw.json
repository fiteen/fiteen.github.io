{"title":"在 Mac 上为 Git 和终端设置代理","date":"2018-09-02T10:59:02.000Z","date_formatted":{"ll":"Sep 2, 2018","L":"09/02/2018","MM-DD":"09-02"},"thumbnail":"2018/set-up-sock5-or-http-proxy-for-git-on-mac/github.png","link":"2018/set-up-sock5-or-http-proxy-for-git-on-mac","comments":true,"tags":["GitHub","Shadowsocks","V2Ray"],"categories":["Git"],"updated":"2022-09-02T06:38:13.741Z","content":"<p>我们常会遇到从 GitHub 中 clone 代码或终端执行命令速度感人的情况，这时如果手上有不错的代理，可以借助代理来更快地下载资源。</p>\n<span id=\"more\"></span>\n<h2 id=\"查看代理的监听地址和端口\">查看代理的监听地址和端口<a title=\"#查看代理的监听地址和端口\" href=\"#查看代理的监听地址和端口\"></a></h2>\n<p>先在本地 Shadowsocks/V2Ray 客户端中查看设置的本机 sock5/http 监听端口和 Host。例如：</p>\n<p><img src=\"/2018/set-up-sock5-or-http-proxy-for-git-on-mac/view-port.png\" alt class=\"φcx\"></p>\n<h2 id=\"git\">Git<a title=\"#git\" href=\"#git\"></a></h2>\n<p>通常我们 clone 代码时有以下两种方式：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># HTTPS 协议</span></span><br><span class=\"line\">https://github.com/accountname/projectname.git</span><br><span class=\"line\"><span class=\"comment\"># SSH 协议</span></span><br><span class=\"line\">git@github.com:accountname/projectname.git</span><br></pre></td></tr></table></figure>\n<h3 id=\"设置-https-协议的代理\">设置 HTTPS 协议的代理<a title=\"#设置-https-协议的代理\" href=\"#设置-https-协议的代理\"></a></h3>\n<p>以上面的配置为例，有如下两种方案：</p>\n<p>设置全局 git 代理，注意这里不需要设置 <code>https.proxy</code>，<a href=\"https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpproxy\" target=\"_blank\">Git Documentation</a> 中没有这个参数。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 设置 socks5 代理</span></span><br><span class=\"line\">git config --global http.proxy socks5://127.0.0.1:1080</span><br><span class=\"line\"><span class=\"comment\"># 用 socks5h 速度更快</span></span><br><span class=\"line\">git config --global http.proxy socks5h://127.0.0.1:1080</span><br><span class=\"line\"><span class=\"comment\"># 设置 http 代理</span></span><br><span class=\"line\">git config --global http.proxy http://127.0.0.1:1087</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注意：<code>ip</code> 和 <code>port</code> 根据自己本地实际配置修改。</p>\n</blockquote>\n<p>取消代理：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git config --global --<span class=\"built_in\">unset</span> http.proxy</span><br></pre></td></tr></table></figure>\n<h3 id=\"单独设置-ssh-协议的代理\">单独设置 SSH 协议的代理<a title=\"#单独设置-ssh-协议的代理\" href=\"#单独设置-ssh-协议的代理\"></a></h3>\n<p>修改用户目录下文件  <code>~/.ssh/config</code> 里的内容，对 GitHub 域名作单独处理：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Host github.com</span><br><span class=\"line\">    <span class=\"comment\"># 若使用的是默认端口，设置如下</span></span><br><span class=\"line\">    HostName           github.com</span><br><span class=\"line\">    <span class=\"comment\"># 如果想用443端口，设置如下</span></span><br><span class=\"line\">    <span class=\"comment\"># Hostname         ssh.github.com</span></span><br><span class=\"line\">    <span class=\"comment\"># Port             443</span></span><br><span class=\"line\">    User               git</span><br><span class=\"line\">    <span class=\"comment\"># 如果是 SOCKS5 代理，取消下面这行注释，并把 1080 改成自己 SOCKS5 代理的端口</span></span><br><span class=\"line\">    ProxyCommand     nc -x localhost:1080 %h %p</span><br><span class=\"line\">    <span class=\"comment\"># 如果是 HTTP 代理，取消下面这行注释，并把 1087 改成自己 HTTP 代理的端口</span></span><br><span class=\"line\">    <span class=\"comment\"># ProxyCommand     socat - PROXY:127.0.0.1:%h:%p,proxyport=1087</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"shell-终端\">Shell 终端<a title=\"#shell-终端\" href=\"#shell-终端\"></a></h2>\n<p>想让终端走代理那么只需在 <code>~/.bashrc</code> 或 <code>~/.zshrc</code> 文件中，直接写入以下内容并保存：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">alias</span> setproxy=<span class=\"string\">&quot;export ALL_PROXY=socks5://127.0.0.1:1080&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">alias</span> unsetproxy=<span class=\"string\">&quot;unset ALL_PROXY&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">alias</span> ip=<span class=\"string\">&quot;curl -i http://ip.cn&quot;</span></span><br></pre></td></tr></table></figure>\n<p>利用终端下载资源时，先执行  <code>setproxy</code> 命令，结束后执行  <code>unsetproxy</code> 命令如果终端提示 <code>command not found: setproxy</code>，说明配置没有生效，执行一下  <code>source ~/.bashrc</code> 或 <code>source ~/.zshrc</code> 即可。</p>\n","prev":{"title":"手把手教你免费搭建 Shadowsocks 服务","link":"2018/build-a-free-shadowsocks-service"},"next":{"title":"借助 Safari 调试苹果手机上的 webView","link":"2018/debug-webview-with-safari"},"plink":"https://blog.fiteen.top/2018/set-up-sock5-or-http-proxy-for-git-on-mac/","toc":[{"id":"查看代理的监听地址和端口","title":"查看代理的监听地址和端口","index":"1"},{"id":"git","title":"Git","index":"2"},{"id":"shell-终端","title":"Shell 终端","index":"3"}],"reward":true,"copyright":{"author":"FiTeen","link":"<a href=\"https://blog.fiteen.top/2018/set-up-sock5-or-http-proxy-for-git-on-mac/\" title=\"在 Mac 上为 Git 和终端设置代理\">https://blog.fiteen.top/2018/set-up-sock5-or-http-proxy-for-git-on-mac/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}